Refactor Books project to work with routing, templates and promises